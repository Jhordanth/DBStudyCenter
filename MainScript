DROP TABLE IF EXISTS AUTORIZACION.USUARIOS_ROL_CESTUDIO;
DROP TABLE IF EXISTS "GENERAL".EMPLEADOS;
DROP TABLE IF EXISTS "GENERAL".CARGOS_CESTUDIO;
DROP TABLE IF EXISTS "GENERAL".LOTES;
DROP TABLE IF EXISTS "GENERAL".ETIQUETAS_ELEMENTOS;
DROP TABLE IF EXISTS "GENERAL".ELEMENTOS;
DROP TABLE IF EXISTS "GENERAL".ETIQUETAS;
DROP TABLE IF EXISTS "GENERAL".INVENTARIOS;
DROP TABLE IF EXISTS "GENERAL".CESTUDIOS;
DROP TABLE IF EXISTS "GENERAL".CLASES_CESTUDIO;
DROP TABLE IF EXISTS "GENERAL".CLASIFICACIONES_CESTUDIO;
DROP TABLE IF EXISTS AUTORIZACION.USUARIOS;
DROP TABLE IF EXISTS "GENERAL".PAIS_INFO;
DROP TABLE IF EXISTS "GENERAL".TIPOS_DOCUMENTO;
DROP TABLE IF EXISTS AUTORIZACION.ROLES_APLICACION;
DROP SCHEMA IF EXISTS AUTORIZACION;
DROP SCHEMA IF EXISTS "GENERAL";

CREATE SCHEMA AUTORIZACION;
CREATE SCHEMA "GENERAL";




GO

CREATE TABLE "GENERAL".SEDE_U(
    ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    NOMBRE VARCHAR(60) UNIQUE,
    CIUDAD VARCHAR(60)
);
GO

CREATE TABLE AUTORIZACION.ROLES_APLICACION(
    ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    NOMBRE_ROL VARCHAR(60) UNIQUE
);
GO
INSERT INTO AUTORIZACION.ROLES_APLICACION (NOMBRE_ROL) VALUES ('Administrador total');
INSERT INTO AUTORIZACION.ROLES_APLICACION (NOMBRE_ROL) VALUES ('Administrador de personal');
INSERT INTO AUTORIZACION.ROLES_APLICACION (NOMBRE_ROL) VALUES ('Administrador de inventario');

CREATE TABLE AUTORIZACION.USUARIOS (
    ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    NOMBRES VARCHAR(60) NOT NULL,
    APELLIDOS VARCHAR(60) NOT NULL,
    CONTRASEGNIA VARCHAR(255) NOT NULL,
    CORREO_ELECTRONICO VARCHAR(30) NOT NULL UNIQUE,
    NUMERO_TELEFONICO VARCHAR(50) NOT NULL UNIQUE,
    ROLE VARCHAR(30) NOT NULL,
    FOREIGN KEY (ID_PAIS) REFERENCES "GENERAL".PAIS_INFO(ID)
);
GO

CREATE TABLE "GENERAL".CESTUDIOS(
	ID	INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	NOMBRE VARCHAR(60) NOT NULL,
	ID_USUARIO_CREACION INT NOT NULL,
	FECHA_FUNDACION DATE,
	FECHA_REGISTRO DATE NOT NULL,
	FECHA_FIN_REGISTRO DATE,
	TELEFONO VARCHAR(50) NOT NULL,
	DIRECCION_SEDE_PRINCIPAL VARCHAR(60),
	CORREO VARCHAR(30) NOT NULL,
	SITIO_WEB VARCHAR(60),
	ICONO VARCHAR(20),
	FOREIGN KEY (ID_USUARIO_CREACION) REFERENCES AUTORIZACION.USUARIOS(ID),
);
GO

CREATE TABLE AUTORIZACION.USUARIOS_ROL_CESTUDIO (
    ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    ID_USUARIO INT NOT NULL,
    ID_ROL INT NOT NULL,
    ID_CESTUDIO INT NOT NULL,
    ID_USUARIO_CREACION INT NOT NULL,
    FECHA_REGISTRO DATE NOT NULL,
    FECHA_FIN_REGISTRO DATE,
    FOREIGN KEY (ID_USUARIO) REFERENCES AUTORIZACION.USUARIOS(ID),
    FOREIGN KEY (ID_USUARIO_CREACION) REFERENCES AUTORIZACION.USUARIOS(ID),
    FOREIGN KEY (ID_ROL) REFERENCES AUTORIZACION.ROLES_APLICACION(ID),
    FOREIGN KEY (ID_CESTUDIO) REFERENCES "GENERAL".CESTUDIOS(ID)
);
GO

CREATE TABLE [GENERAL].CARGOS_CESTUDIO (
	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    NOMBRE VARCHAR(60) NOT NULL,
    FECHA_CREACION_REGISTRO DATE,
    FECHA_FINALIZACION_REGISTRO DATE,
    USUARIO_CREACION_REGISTRO INT,
    DESCRIPCION VARCHAR(200),
    ID_CESTUDIO INT,
    FOREIGN KEY (USUARIO_CREACION_REGISTRO) REFERENCES AUTORIZACION.USUARIOS(ID),
    FOREIGN KEY (ID_CESTUDIO) REFERENCES "GENERAL".CESTUDIOS(ID)
);
GO

CREATE TABLE [GENERAL].TIPOS_DOCUMENTO (
	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    NOMBRE VARCHAR(60) NOT NULL,
    SIGLA VARCHAR(20),
    DESCRIPCION VARCHAR(500),
    TIPO_DOCUMENTO VARCHAR (60)
)

INSERT INTO [GENERAL].TIPOS_DOCUMENTO (NOMBRE, SIGLA, DESCRIPCION, TIPO_DOCUMENTO)
VALUES 
('Contrato a Término Fijo', 'CTF', 'Contrato por un período de tiempo específico, que se debe establecer en el momento de la firma.', 'CONTRATO'),
('Contrato a Término Indefinido', 'CTI', 'Contrato que no tiene una fecha de finalización y se mantiene vigente mientras no sea terminado por alguna de las partes.', 'CONTRATO'),
('Contrato por Obra o Labor', 'COL', 'Contrato que se firma para la realización de una obra o labor específica. Finaliza cuando dicha obra o labor termina.', 'CONTRATO'),
('Contrato de Aprendizaje', 'CA', 'Contrato especial que se firma entre un empleador y un aprendiz que se encuentra en una etapa de formación.', 'CONTRATO'),
('Contrato de Trabajo Temporal', 'CTT', 'Contrato que se firma para la prestación de servicios durante un período limitado, normalmente a través de una CESTUDIO temporal.', 'CONTRATO'),
('Contrato de Prestación de Servicios', 'OPS', 'Contrato civil o comercial en el cual una persona natural o jurídica se obliga a prestar un servicio de manera independiente sin que haya subordinación.', 'CONTRATO'),
('Contrato a Medio Tiempo', 'CMT', 'Contrato laboral que establece que el trabajador dedicará menos de la jornada completa, con los beneficios proporcionales.', 'CONTRATO'),
('Contrato de Trabajo Remoto', 'CTR', 'Contrato en el que el trabajador presta sus servicios de forma remota, fuera de las instalaciones del empleador.', 'CONTRATO'),
('Contrato de Trabajo por Horas', 'CTH', 'Contrato en el que se establece que el trabajador prestará sus servicios por un número determinado de horas, generalmente en casos específicos.', 'CONTRATO'),
('Contrato de Pasantía', 'CP', 'Contrato firmado con estudiantes que buscan una primera experiencia laboral y no tiene relación directa con una vinculación laboral.', 'CONTRATO'),
('Contrato Ocasional o Transitorio', 'COT', 'Contrato temporal para satisfacer necesidades ocasionales, accidentales o transitorias del empleador. Su duración no puede exceder un mes.', 'CONTRATO'),
('Cédula de Ciudadanía', 'CC', 'Documento de identidad para ciudadanos colombianos mayores de 18 años', 'IDENTIFICACION'),
('Tarjeta de Identidad', 'TI', 'Documento de identidad para colombianos menores de 18 años', 'IDENTIFICACION'),
('Registro Civil de Nacimiento', 'RC', 'Documento que acredita el nacimiento de una persona en Colombia', 'IDENTIFICACION'),
('Cédula de Extranjería', 'CE', 'Documento de identificación para extranjeros residentes en Colombia', 'IDENTIFICACION'),
('Pasaporte', 'P', 'Documento de viaje internacional emitido por el estado colombiano', 'IDENTIFICACION'),
('Permiso Especial de Permanencia', 'PEP', 'Documento de identidad temporal para extranjeros en situación regular en Colombia', 'IDENTIFICACION'),
('Documento de Identificación de Migrantes Venezolanos (DIM)', 'DIM', 'Documento para migrantes venezolanos bajo el Estatuto Temporal de Protección', 'IDENTIFICACION'),
('Número de Identificación Tributaria (NIT)', 'NIT', 'Documento para la identificación fiscal de personas naturales o jurídicas', 'IDENTIFICACION');




CREATE TABLE GENERAL.EMPLEADOS (
	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
    NOMBRES VARCHAR(60) NOT NULL,
    APELLIDOS VARCHAR(60),
    ID_TIPO_DOCUMENTO_IDENTIFACION INT,
    NRO_ID VARCHAR(20),
    IDENTIFICADOR_CESTUDIO VARCHAR(20) UNIQUE,
    TELEFONO_LABORAL VARCHAR(50),
    CORREO_ELECTRONICO_LABORAL VARCHAR(30),
    DIRECCION_VIVIENDA VARCHAR(30),
    ID_CARGO INT,
    ID_CESTUDIO INT NOT NULL,
    SALARIO NUMERIC(15,2),
    HORAS_SEMANALES INT,
    ID_TIPO_CONTRATO INT,
    NOTAS VARCHAR(500),
    FECHA_CONTRATACION DATE,
    FECHA_FINALIZACION_CONTRATACION DATE,
    MOTIVO_FINALIZACION_CONTRATACION VARCHAR(500),
    FECHA_CREACION_REGISTRO DATE NOT NULL,
    FECHA_FINALIZACION_REGISTRO DATE,
    ID_SUPERVISOR INT,
    FOREIGN KEY (ID_CARGO) REFERENCES [GENERAL].CARGOS_CESTUDIO(ID),
    FOREIGN KEY (ID_TIPO_CONTRATO) REFERENCES [GENERAL].TIPOS_DOCUMENTO(ID),
    FOREIGN KEY (ID_SUPERVISOR) REFERENCES [GENERAL].EMPLEADOS(ID),
    FOREIGN KEY (ID_CESTUDIO) REFERENCES [GENERAL].CESTUDIOS(ID)
);
GO



CREATE TABLE GENERAL.INVENTARIOS (

	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	NOMBRE VARCHAR(60) NOT NULL,
	ID_CESTUDIO INT NOT NULL,
	DIRECCION_FISICA VARCHAR(30),
	FECHA_CREACION_REGISTRO DATE NOT NULL,
    FECHA_FINALIZACION_REGISTRO DATE,
	FOREIGN KEY (ID_CESTUDIO) REFERENCES [GENERAL].CESTUDIOS(ID)
);

CREATE TABLE GENERAL.ETIQUETAS (

	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	NOMBRE VARCHAR(60) NOT NULL,
	DESCRIPCION VARCHAR(200),
	ID_CESTUDIO INT NOT NULL,
	FECHA_CREACION_REGISTRO DATE NOT NULL,
    FECHA_FINALIZACION_REGISTRO DATE,
	FOREIGN KEY (ID_CESTUDIO) REFERENCES [GENERAL].CESTUDIOS(ID)
);

CREATE TABLE GENERAL.ELEMENTOS (

	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	NOMBRE VARCHAR(60) NOT NULL,
	CODIGO VARCHAR(60),
	DESCRIPCION VARCHAR(200),
	ID_CESTUDIO INT NOT NULL,
	FECHA_CREACION_REGISTRO DATE NOT NULL,
    FECHA_FINALIZACION_REGISTRO DATE,
	FOREIGN KEY (ID_CESTUDIO) REFERENCES [GENERAL].CESTUDIOS(ID)
);


CREATE TABLE GENERAL.ETIQUETAS_ELEMENTOS (

	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	ID_ELEMENTO INT NOT NULL,
	ID_ETIQUETA INT NOT NULL,
	FOREIGN KEY (ID_ELEMENTO) REFERENCES [GENERAL].ELEMENTOS(ID),
	FOREIGN KEY (ID_ETIQUETA) REFERENCES [GENERAL].ETIQUETAS(ID)
);

CREATE TABLE GENERAL.LOTES (

	ID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
	LOTE VARCHAR(60),
	ID_ELEMENTO INT NOT NULL,
	EXISTENCIAS INT NOT NULL,
	ID_INVENTARIO INT NOT NULL,
	VALOR_UNITARIO INT NOT NULL,
	FECHA_CREACION_REGISTRO DATE NOT NULL,
    FECHA_FINALIZACION_REGISTRO DATE,
	FOREIGN KEY (ID_ELEMENTO) REFERENCES [GENERAL].ELEMENTOS(ID),
	FOREIGN KEY (ID_INVENTARIO) REFERENCES [GENERAL].INVENTARIOS(ID)
);
